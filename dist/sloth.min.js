!function(){"use strict";function t(t,i){i=i||{},this.$element=t||$("[data-src]").first(),this.$preloader=i.$preloader||$(document.body),this.isInline="img"===this.$element[0].tagName.toLowerCase(),this.source=this.$element.attr("data-src"),this.isWidthInherited=!1,this.initialWidth=0,this.initialHeight=0,this.width=0,this.init().bind()}function i(i,e){t.call(this,i,e)}function e(i,e){t.call(this,i,e)}t.prototype.init=function(){return this.parseSource(),this.wrap(),this.preload($.proxy(this.onLoad,this)),this},t.prototype.wrap=function(){},t.prototype.onLoad=function(){},t.prototype.reserveSpace=function(){var t=(this.$element.parent(),parseInt(this.$element.css("width"),10));t?(this.initialWidth=t,this.width=""!==this.$element.get(0).style.width?this.$element.get(0).style.width:this.initialWidth):(this.initialWidth=parseInt(this.$element.parent().css("width")),this.width=this.initialWidth,"none"!==this.$element.css("max-width")&&(this.width="")),this.initialHeight=9*this.initialWidth/16,this.$element.css("width","100%")},t.prototype.preload=function(t){var i=$("<img />");console.log("Start preloading image"),i.hide().appendTo(this.$preloader).on("load",function(){t(i)}).attr("src",this.source)},t.prototype.parseSource=function(){this.source=this.$element.attr("data-src")},t.prototype.bind=function(){return this},t.prototype.reset=function(){return this},t.prototype.unbind=function(){return this},i.prototype=new t,i.prototype.constructor=t,i.prototype.wrap=function(){var t=$('<div class="sloth__content" />'),i=$('<div class="sloth__background" />');this.$element.css("position")&&this.$element.css("position","relative"),t.css({position:"relative","z-index":2}),i.css({position:"absolute",top:0,left:0,right:0,bottom:0,"z-index":1,background:this.$element.css("background")}).hide(),this.$element.addClass("sloth is-loading").wrapInner(t).append(i)},i.prototype.onLoad=function(t){this.$element.removeClass("is-loading"),this.$element.find(".sloth__background").css("background-image","url("+t.attr("src")+")").fadeIn(440)},e.prototype=new t,e.prototype.constructor=t,e.prototype.wrap=function(){var t=$('<span class="sloth is-loading" />');this.reserveSpace(),t.css({width:this.initialWidth,height:this.initialHeight,display:"inline-block","max-width":this.$element.css("max-width"),"font-size":0}),this.$element.css("display","block"),this.$element.wrap(t)},e.prototype.onLoad=function(t){var i=this.$element.closest(".sloth");i.removeClass("is-loading"),i.css("width",this.width),this.$element.hide().attr("src",t.attr("src")).fadeIn(440),i.animate({height:this.initialWidth/t.width()*t.height()},440,function(){i.css("height","")})},exports.init=function(){$("[data-src]").each(function(){"img"===$(this)[0].tagName.toLowerCase()?new e($(this)):new i($(this))})}}();